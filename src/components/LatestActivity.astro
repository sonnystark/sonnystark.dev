---
import { getCollection } from 'astro:content'
import { formattedDate } from '../utils/formattedDate'
import '../styles/global.css'
const posts = (await getCollection('posts'))
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
  .slice(0, 3)

const projects = (await getCollection('projects'))
  .sort(
    (a, b) =>
      Number(b.data.featured) - Number(a.data.featured) || a.data.title.localeCompare(b.data.title)
  )
  .slice(0, 3)
---

<h3>Check out what's new:</h3>
<section class="latest-activity">
  <div class="latest-section">
    <h4>Latest Blog Posts</h4>
    <ul>
      {
        posts.map((post) => (
          <li>
            <a href={`/blog/${post.slug}`}>&rarr;
              {post.data.title} |{' '}
              <span class="formatted-date">{formattedDate({ date: post.data.pubDate })}</span>
            </a>
          </li>
        ))
      }
    </ul>
  </div>
  <div class="latest-section">
    <h4>Latest Projects</h4>
    <ul>
      {
        projects.map((project) => (
          <li>
            <a href={project.data.githubUrl} target="_blank" rel="noopener noreferrer">&rarr;
              {project.data.title} &nearr;
            </a>
          </li>
        ))
      }
    </ul>
  </div>
</section>

<style>
  .latest-activity {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
    margin: var(--spacing-md) 0;
  }

  .latest-section {
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-md);
    transition: box-shadow 0.2s;
  }

  .latest-section h4 {
    margin-top: 0;
    margin-bottom: var(--spacing-md);
  }

  ul {
    list-style: none;
    margin: 0;
    padding: 0;
  }

  li {
    font-size: var(--font-size-small);
    margin-bottom: var(--spacing-sm);
    padding: var(--spacing-xs) 0;
    border-bottom: 1px solid var(--color-primary);
    transition: background 0.2s;
  }

  }

  li:last-child {
    border-bottom: none;
  }

  a {
    /* color: var(--color-primary); */
    text-transform: uppercase;
    /* text-decoration: none; */
    font-family: var(--font-family-mono);
    transition: color 0.2s;
    padding: 0.2em 0.1em;
    display: inline-block;
  }

  a > span {
    text-transform: none;
    font-weight: 100;
  }
</style>
